<!DOCTYPE html>
<html>

	<head lang="en">
		<meta charset="UTF-8">
		<title>jquery.validationEngine</title>
		<link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.1/css/bootstrap.min.css">
		<link href="//cdn.bootcss.com/jQuery-Validation-Engine/2.6.4/validationEngine.jquery.min.css" rel="stylesheet">
		<script src="../../agile/assets/third/jquery/jquery-2.1.3.js"></script>
		<script src="//cdn.bootcss.com/jQuery-Validation-Engine/2.6.4/languages/jquery.validationEngine-zh_CN.min.js"></script>
		<script src="//cdn.bootcss.com/jQuery-Validation-Engine/2.6.4/jquery.validationEngine.min.js"></script>
		<style type="text/css">
			.formError .formErrorContent {
				background-color: #00ABA9;
			}
		</style>
		<script>
			$(document).ready(function() {
				$("#demoForm").validationEngine('attach', {
					showOneMessage: true,
					"custom_error_messages": {
						"#email": {
							'required': {
								'message': "邮件必填"
							},
							'custom[email]': {
								'message': "邮件格式错误"
							}
						}
					},
					promptPosition: "top",
					scroll: false
//					onValidationComplete: function(form, status) {
//						//可以通过这里阻止表单提交
//						console.log("The form status is: " + status + ", it will never submit");
//						if(status) {
//							if(confirm("是否允许提交")) {
//								return true;
//							}
//							return false;
//						}
//					}
				});
				//				$("#demoForm").validationEngine().css({border : "2px solid green"})
				$("#check").click(function() {
					console.log($("#demoForm").validationEngine('validate'));
				});
			});

			function checkNum(field, rules, i, options) {
				if(field.val() < 0) {
					return "该输入必须大于0";
				}
			}

			function checkDomain(field, rules, i, options) {
				if(!validDomain(field.val())) {
					return "请输入正确的domain";
				}
			}

			function CheckIsValidDomain(domain) {
				return /^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z]{2,})+$/.test(domain);
			}

			//检测域名 www.baidu.com格式
			function validDomain(domain) {
//				/^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z]{1,})+$/
				if(/^[a-zA-Z0-9-]{1,61}(?:\.[a-zA-Z]{1,})+$/.test(domain)) {
//					console.log("Valid Domain Name");
					return true;
				} else {
//					console.log("Enter Valid Domain Name");
					return false;
				}
			}

			function getHostName(url) {
				var match = url.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);
				if(match != null && match.length > 2 && typeof match[2] === 'string' && match[2].length > 0) {
					return match[2];
				} else {
					return null;
				}
			}

			function getDomain(url) {
				var hostName = getHostName(url);
				var domain = hostName;

				if(hostName != null) {
					var parts = hostName.split('.').reverse();

					if(parts != null && parts.length > 1) {
						domain = parts[1] + '.' + parts[0];

						if(hostName.toLowerCase().indexOf('.co.uk') != -1 && parts.length > 2) {
							domain = parts[2] + '.' + domain;
						}
					}
				}

				return domain;
			}
			
			function checkField(id){
				console.log("校验结果:%s",$("#"+id).validationEngine('validate'));
			}
		</script>
	</head>

	<body>
		<!--文档地址:http://posabsolute.github.io/jQuery-Validation-Engine/#custom_error_messages-->
		<div class="container">
			<form id="demoForm" action="http://127.0.0.1" class="form-control" method="get">
				<fieldset>
					<fieldset>
						<legend id="legendid">Email</legend>
						<a href="#" onclick="$('#legendid').validationEngine('showPrompt', 'This a custom msg', 'load')">Show prompt</a>
					</fieldset>
					<legend>用户登录</legend>
					<p id="info"></p>
					<p id="info2" style="display: none">输入错误</p>
					<p>
						<label for="username">用户名</label>
						<input type="text" id="username" class="form-control validate[required]" name="username" />
					</p>

					<p>
						<label for="password">密码</label>
						<input type="password" id="password" class="form-control validate[required]" name="password" />
					</p>

					<p>
						<label for="confirm-password">确认密码</label>
						<input type="password" id="confirm-password" class="form-control validate[required,equals[password]]" name="confirm-password" />
					</p>

					<p>
						<label for="confirm-password">邮件</label>
						<input id="email" type="text" class="form-control validate[required,custom[email],minSize[3],maxSize[10]]" name="email" />
					</p>

					<p>
						<label for="confirm-password">手机</label>
						<input id="phone" type="text" class="form-control validate[required,custom[phone],minSize[11],maxSize[11]]" maxlength="11" name="phone" />
					</p>

					<p>
						<label for="confirm-password">自定义函数验证</label>
						<input id="num" type="text" class="form-control validate[required,custom[number],funcCall[checkNum],min[1],max[100.05]]" name="num" />
					</p>
					<p>
						<label for="confirm-file">文件</label>
						<input id="file" type="file" class="form-control validate[required]" name="file" />
					</p>
					<p>
						<label for="confirm-password">domain</label>
						<input type="text" class="form-control validate[required,funcCall[checkDomain]]" id="domain" name="domain" />
						<a class="btn btn-warning" onclick="checkField('domain');">手动验证该字段</a>
					</p>
					<p>
						<input class="validate[minCheckbox[2]]" type="checkbox" name="group1" id="maxcheck1" value="5" />
						<input class="validate[minCheckbox[2]]" type="checkbox" name="group1" id="maxcheck2" value="3" />
						<input class="validate[minCheckbox[2]]" type="checkbox" name="group1" id="maxcheck3" value="9" />
						<hr /> condrequired(两者需要同时填写/或者不写):
						<input value="" type="text" name="creditcard" class="validate[condRequired[ccv]]" id="creditcard" />
						<input class="validate[condRequired[creditcard]]" type="text" id="ccv" name="ccv" />
					</p>
					<p>
						<button id="check" class="btn btn-default">检查表单</button>
					</p>
					<p>
						<input value="" class="validate[groupRequired[payments]]" type="text" name="creditcard" id="creditcard" />
						<input class="validate[groupRequired[payments]]" type="text" id="paypal" name="paypal" />
					</p>
					<p>
						<a href="#" onclick="$('#legendid').validationEngine('showPrompt', 'This a custom msg', 'load')">Show prompt</a>
						<input type="submit" class="btn btn-default" value="登录" />
					</p>
				</fieldset>
			</form>
		</div>
	</body>

</html>